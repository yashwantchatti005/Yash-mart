<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Your Cart | Yashmart</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="wepsite.css">
</head>
<body>

<div class="container my-5">
  <h2 class="text-center mb-4">üõí Your Shopping Cart</h2>
  <div id="cartContainer" class="row g-3"></div>

  <div class="text-center mt-4">
    <h4 id="totalAmount">Total: ‚Çπ0</h4>
    <h4 id="finalAmount" class="fw-bold text-success"></h4>
    <button id="checkoutBtn" class="btn btn-success mt-3 me-2">Proceed to Checkout</button>
    <button id="clearCartBtn" class="btn btn-danger mt-3">Clear Cart</button>
  </div>
</div>

<script>
let cartItems = JSON.parse(localStorage.getItem('cart')) || [];
let discountShown = false;

function displayCart() {
  const container = document.getElementById('cartContainer');
  container.innerHTML = '';
  let total = 0;

  if(cartItems.length === 0){
    container.innerHTML = '<p class="text-center text-danger">Your cart is empty üõçÔ∏è</p>';
    document.getElementById('totalAmount').textContent = "Total: ‚Çπ0";
    document.getElementById('finalAmount').textContent = "";
    return;
  }

  cartItems.forEach((item, index) => {
    if(!item.quantity) item.quantity = 1;
    total += item.price * item.quantity;

    const col = document.createElement('div');
    col.className = 'col-md-4';
    col.innerHTML = `
      <div class="card h-100 shadow-sm text-center">
        <img src="${item.image}" class="card-img-top" alt="${item.name}" height="180">
        <div class="card-body">
          <h5>${item.name}</h5>
          <p>‚Çπ${item.price} x ${item.quantity}</p>
          <div class="d-flex justify-content-center gap-2">
            <button class="btn btn-sm btn-outline-secondary" onclick="changeQuantity(${index}, -1)">-</button>
            <button class="btn btn-sm btn-outline-secondary" onclick="changeQuantity(${index}, 1)">+</button>
          </div>
          <button class="btn btn-danger btn-sm mt-2" onclick="removeItem(${index})">Remove</button>
        </div>
      </div>`;
    container.appendChild(col);
  });

  let finalTotal = total;
  if(total >= 499){
    const discount = total * 0.10;
    finalTotal = total - discount;
    if(!discountShown){
      alert(`üéâ 10% Discount Applied! Final Total: ‚Çπ${finalTotal.toFixed(2)}`);
      discountShown = true;
    }
  } else {
    discountShown = false;
  }

  document.getElementById('totalAmount').textContent = "Total: ‚Çπ" + total.toFixed(2);
  document.getElementById('finalAmount').textContent = total >= 499 ? "Final Total: ‚Çπ" + finalTotal.toFixed(2) : "";
}

function changeQuantity(index, delta){
  cartItems[index].quantity = Math.max(1, cartItems[index].quantity + delta);
  localStorage.setItem('cart', JSON.stringify(cartItems));
  displayCart();
}

function removeItem(index){
  cartItems.splice(index, 1);
  localStorage.setItem('cart', JSON.stringify(cartItems));
  displayCart();
}

document.getElementById('clearCartBtn').addEventListener('click', ()=>{
  if(confirm("Are you sure you want to clear the cart?")){
    cartItems = [];
    localStorage.removeItem('cart');
    displayCart();
  }
});

displayCart();
</script>

</body>
</html>
